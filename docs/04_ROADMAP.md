# 開発ロードマップと課題管理

## 現在のステータス
**フェーズ0.5: プロトタイプUIの完成とバグフィックス**
フロントエンドの主要なUIコンポーネントが完成し、モックデータを用いた状態遷移が概ね動作する状態。

### 最近の修正履歴
- [x] **研修申込バグの修正**: `MemberForm.tsx` において、非同期処理（`setTimeout`）内のクロージャによる古いStateの参照問題を修正。同期的に新しいオブジェクトを生成することで、画面遷移後も申込状態が維持されるように改善。
- [x] **UI改善**: サイドバーのユーザーステータス表示位置を、メニュー下部から上部（視認性の高い位置）へ移動。
- [x] **ドキュメント整備**: `docs/` ディレクトリの作成と設計書の言語化。

---

## 今後の開発フェーズ

### フェーズ 1: バックエンド・データベース連携 (Next Step)
現在はブラウザのメモリ上（React State）でデータを管理しているため、リロードするとデータが初期化される。
これを永続化するため、**Google Workspace for Nonprofits** の環境（GAS + スプレッドシート）への連携を実装する。

- **タスク**:
  - `backend/Code.gs` の実装（スプレッドシートの読み書きを行うGAS側のAPI構築）。
  - Viteのビルド設定変更（`vite-plugin-singlefile` を導入し、Reactアプリを1つのHTMLファイルとして出力可能にする）。
  - `services/api.ts` を本番のGAS URLに向けるよう修正。
  - データのCRUD処理の完全な非同期化と、エラーハンドリング（Toast通知等）の強化。

### フェーズ 2: 認証・認可 (Authentication)
現在は画面右上のドロップダウンで「デモユーザー」を切り替えることでログインをシミュレーションしている。
GWNP環境に合わせたセキュアなログイン機構を構築する。

- **タスク**:
  - **マジックリンク認証** または **パスワード認証** の実装（GAS側でトークンを発行し、メールでログインURLを送信する仕組みなど）。
  - `App.tsx` のルーティングガード（未ログイン時のリダイレクト処理）の実装。

### フェーズ 3: 事務局機能の拡充
- **タスク**:
  - 会員データのCSVエクスポート/インポート機能。
  - 研修参加者リストの出力機能。
  - 年会費の一括請求メール送信機能（Gemini API連携の拡張）。

---

## 既知の課題・制限事項
1. **排他制御**: 現在の設計では、同一事業所の職員Aと職員Bが同時にデータを編集した場合、後勝ち（Last Write Wins）となりデータが上書きされるリスクがある。
2. **バリデーション**: フロントエンドのバリデーションは実装されているが、バックエンド連携時にはサーバーサイドでの厳密なバリデーションが必要。
